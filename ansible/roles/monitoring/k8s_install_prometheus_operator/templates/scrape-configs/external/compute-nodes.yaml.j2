{% if prometheus_monitor_components.external.computeNodes  %}
  {% if groups['compute_node'] is defined and (groups['compute_node'] | length > 0) %}
- job_name: 'compute-node-exporter'
  honor_labels: true
  static_configs:
    {% for host in groups['compute_node'] %}
    - targets:
      - {{ hostvars[host].metrics_exporter_ip +":"+(node_exporter_port | string) }}
      labels:
        _cluster: '{{ hostvars[host].k8s_cluster_name }}'
        cluster: '{{ hostvars[host].k8s_cluster_name }}'
        server: '{{ hostvars[host].server_hostname }}'
    {% endfor %}
- job_name: 'compute-frr-exporter'
  honor_labels: true
  static_configs:
    - targets:
    {% for host in groups['compute_node'] %}
      - {{ hostvars[host].metrics_exporter_ip +":"+(frr_exporter_port | string) }}
    {% endfor %}
  {% endif %}
{% endif %}
